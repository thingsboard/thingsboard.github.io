{% if page.url == "/partners/hardware/" %}
    {% assign firstCompaniesInList = page.firstCompaniesInList | split: "%" %}

    {% assign sortedCollection = site.data.hardware-partners | sort: 'name' %}

    {% assign priorityCollection = "" | split: "" %}
    {% for pname in firstCompaniesInList %}
        {% assign company = sortedCollection | where: "name", pname | first %}
        {% if company %}
            {% assign priorityCollection = priorityCollection | push: company %}
        {% endif %}
    {% endfor %}

    {% assign remainingCollection = "" | split: "" %}
    {% for company in sortedCollection %}
        {% unless firstCompaniesInList contains company.name %}
            {% assign remainingCollection = remainingCollection | push: company %}
        {% endunless %}
    {% endfor %}

    {% assign finalCollection = priorityCollection | concat: remainingCollection %}

    <div class="card-collection" id="card-collection">
        {% for card in finalCollection %}
            <a class="card" href="{{ card.page }}" data-hardware-types="{{ card.hardware-types | join: '|' }}" data-connectivity="{{ card.type | join: '|' }}" data-industry="{{ card.industry | join: '|' }}" data-use-cases="{{ card.use-case | join: '|' }}" target="_blank">
                <div class="card-wrapper">
                    <div class="card-image">
                        <img class="logo" src="{{ card.logo }}" alt="{{ card.name }} logo" loading="lazy">
                    </div>
                    <div class="crisp-container" data-tooltip="Industries:&#10;{{ card.industry | join: '&#10;' }}">
                        <span class="crisp">{{ card.industry[0] }}</span>
                        {% assign industrySize = card.industry | size %}
                        {% if industrySize > 1 %}
                            <span class="crisp">+{{ industrySize | minus: 1 }}</span>
                        {% endif %}
                    </div>
                    <p class="card-title">{{ card.name }}</p>
                    <p class="card-description">{{ card.description }}</p>
                    <div class="card-link-wrapper">
                    <span class="card-link" href="#">
                        See integration guides
                        <i class="fas fa-chevron-right arrow first blue-chevron"></i>
                        <i class="fas fa-chevron-right arrow second blue-chevron"></i>
                        <i class="fas fa-chevron-right arrow third blue-chevron"></i>
                    </span>
                    </div>
                </div>
            </a>
        {% endfor %}
    </div>
{% elsif page.url == "/devices-library/" %}

    {%- assign dirs = "
        devices-library/ce/,
        devices-library/pe/,
        devices-library/paas/,
        devices-library/edge/,
        devices-library/pe-edge/
    " | split: "," -%}

    <ul class="devices-library-list">
        {%- for dir in dirs -%}
            {%- assign trimmed_dir = dir | strip -%}

            {%- assign pages_in_dir = site.pages
                    | where_exp: "p", "p.path contains trimmed_dir"
            -%}

            <p>Количество страниц: {{ pages_in_dir | size }}</p>

            {%- for page in pages_in_dir -%}
                {% assign deviceName = page.title | replace: "How to connect ", "" | replace: " to ThingsBoard?", "" %}
                <h1>{{ deviceName }}</h1>
                {% if page.industry %}
                    <ul>
                        {% for item in page.industry %}
                            <li>{{ item }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}


            {%- endfor -%}
        {%- endfor -%}
    </ul>

{% endif %}