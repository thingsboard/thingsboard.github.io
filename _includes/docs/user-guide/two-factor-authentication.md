* TOC
{:toc}

Two-factor authentication (2FA) adds an extra layer of security to user sign-in. When 2FA is enabled, users must complete an additional identity verification step in addition to entering their password.

This approach significantly reduces the risk of unauthorized access, even if user credentials are compromised.

ThingsBoard supports multiple 2FA verification methods, which can be enabled and configured by administrators and selectively activated by tenants.

{% if docsPrefix == null %}
![image](/images/user-guide/two-factor-authentication/two-factor-authentication-ce.png)
{% endif %}
{% if (docsPrefix == "pe/") or (docsPrefix == "paas/") or (docsPrefix == "paas/eu/") %}
![image](/images/user-guide/two-factor-authentication/two-factor-authentication-pe.png)
{% endif %}

## Two-factor authentication methods

- **Email**. A one-time verification code is sent to the userâ€™s email address after entering valid credentials. To use email-based 2FA, a system administrator should configure an [outgoing mail server](/docs/{{docsPrefix}}user-guide/ui/mail-settings/){:target="_blank"}.
- **SMS**. A one-time verification code is sent to the user&#39;s phone number via SMS. To use SMS-based 2FA, an [SMS provider](/docs/{{docsPrefix}}user-guide/ui/sms-provider-settings/){:target="_blank"} must be configured by the system administrator.
- **Authenticator app (TOTP)**. A time-based one-time password (TOTP) is generated using an external authenticator application. Users can use popular apps such as **Google Authenticator**, **Authy**, or **Duo**.
- **Backup code**. Backup codes are single-use codes generated by the user and stored securely (downloaded or printed). Backup codes can be used **only in combination with at least one other enabled 2FA method** and cannot be configured as a standalone authentication option.

## Configure two-factor authentication

{% unless docsPrefix == 'paas/' or docsPrefix == 'paas/eu/' %}System administrator configures the available 2FA providers for [tenants](/docs/{{docsPrefix}}user-guide/ui/tenants/){:target="_blank"} and can [enforce 2FA](#enforced-two-factor-authentication) for specific user groups.{% endunless %}   
{% if docsPrefix == null %}Tenants can then choose whether to enable 2FA for their own accounts, unless 2FA is enforced for them.{% endif %}   
{% unless docsPrefix == null %}[Tenant administrators](/docs/{{docsPrefix}}user-guide/ui/tenants/){:target="_blank"} can either use the system administrator&#39;s 2FA configuration or define a custom 2FA configuration for themselves and their users.{% endunless %}

**To configure 2FA:**
- Log in to ThingsBoard as a {% if docsPrefix == null %}System administrator{% endif %}{% if docsPrefix == 'pe/' %}System administrator or Tenant administrator{% endif %}{% if docsPrefix == 'paas/' or docsPrefix == 'paas/eu/' %}Tenant Administrator{% endif %}.
- Navigate to "Security" &#8702; "Two-factor authentication".
{% unless docsPrefix == null %}- {% endunless %}{% unless docsPrefix == 'paas/' or docsPrefix == 'paas/eu/' or docsPrefix == null %}(Tenant administrator only) {% endunless %}{% unless docsPrefix == null %}Clear "Use system two factor auth settings" to configure tenant-specific settings.{% endunless %}
- Enable one or more verification methods:
  - Authenticator app
  - SMS 
  - Email
  - Backup codes
- Configure provider-specific options such as:
  - Verification limitations
  - Verification code check rate limit
- Click "Save" to apply the configuration.

**Note:** The 2FA methods available to end users depend on the configuration defined on this page.

{% include images-gallery.html imageCollection="2fa-configuration" %} 

{% unless docsPrefix == 'paas/' or docsPrefix == 'paas/eu/' %}

## Enforced two-factor authentication

_&#42; Available to system administrators only_

Starting from **ThingsBoard 4.3**, a System administrator can enforce 2FA for one of the following user groups: **all users**, **system administrators**, or selected (or all) **tenant administrators**.   
When 2FA is enforced, affected users must configure and use at least one available 2FA method before they can continue using the platform.

### Configuring enforced 2FA

- Log in as a System administrator.
- Navigate to "Security" &#8702; "Two-factor authentication". 
- Enable "Enforce two-factor authentication". 
- Select the user group for which you want to enforce 2FA:   
   &#8211; All users   
   &#8211; System administrators   
   &#8211; Tenant administrators
  - (For Tenant administrators) Select specific Tenants or Tenant profiles, or leave the field empty to apply enforcement globally.
- Configure the available 2FA providers.
- Click "Save".

{% include images-gallery.html imageCollection="2fa-enforce-1" %}

<b><font size="3">Enforcing 2FA for tenant administrators</font></b>

When enforcing 2FA for Tenant administrators, use the selector to switch between Tenant / Tenant profile scope to apply the policy only to specific tenants or tenant profiles.   
If no tenants or tenant profiles are selected, the enforcement applies to all tenants or all tenant profiles, respectively.

{% include images-gallery.html imageCollection="2fa-enforce-2" %}

{% endunless %}

## Enable 2FA for a user account

Users can enable 2FA for their own accounts using one or more methods configured by the administrator.

To enable 2FA as a user:
- Log in to ThingsBoard.
- Open the user menu (three dots) in the top-right corner and select "Account".
- Navigate to the "Security" tab.
- Enable one or more available 2FA methods and complete the setup steps.

{% include images-gallery.html imageCollection="2fa-password-and-authentication" %}

{% capture difference %}
**Important!** The list of 2FA options available depends on the settings on the ["Two-factor authentication" page](#configure-two-factor-authentication).
{% endcapture %}
{% include templates/info-banner.md content=difference %}

### Authenticator app

**Enable authenticator app verification:**
- Open "Account" &#8702; "Security".
- Enable authentication via Authenticator app.
- Open the authenticator app on your mobile device.
- Scan the displayed QR code.
- Enter the 6-digit code generated by the app.
- Click "Done".

{% include images-gallery.html imageCollection="2fa-app-1" %}

**Sign-in with authenticator app:**
- Enter your username and password.
- Enter the 6-digit code generated by the authenticator app.

{% include images-gallery.html imageCollection="2fa-app-2" %}

### SMS verification

**Enable SMS verification:**
- Open "Account" &#8702; "Security".
- Enable authentication via SMS.
- Enter your phone number.
- Enter the 6-digit code received via SMS.
- Click "Done".

{% include images-gallery.html imageCollection="2fa-sms-1" %}

**Sign-in with SMS**

**During sign-in:**
- Enter your username and password.
- Enter the verification code received via SMS.

{% include images-gallery.html imageCollection="2fa-sms-2" %}

### Email verification

**Enable email verification:**
- Open "Account" &#8702; "Security".
- Enable authentication via Email.
- Enter the 6-digit code received via email.
- Click "Done", then "Save".

{% include images-gallery.html imageCollection="2fa-email-1" %}

**Sign-in with email:**
- Enter your username and password.
- Enter the verification code received via email.

{% include images-gallery.html imageCollection="2fa-email-2" %}

### Backup codes

Backup codes provide an alternative authentication method when other 2FA methods are unavailable (for example, if the mobile device is lost).

> **Note:** this method can be used only in combination with at least one other enabled 2FA method and cannot be configured as a standalone authentication option.

**Generate backup codes:**
- Open "Account" &#8702; "Security".
- Enable authentication via backup codes.
- Download or print the generated backup codes and store them securely.
- Click "Done".

> Each backup code can be used only once.

{% include images-gallery.html imageCollection="2fa-backup-code-1" %}

**Sign-in with a backup code:**
- Start sign-in by entering your username and password.
- Click "Try another way".
- Select "Backup code".
- Enter an unused backup code from your list.
- Click "Continue".

{% include images-gallery.html imageCollection="2fa-backup-code-2" %}

## Next steps

{% assign currentGuide = "AdvancedFeatures" %}{% include templates/multi-project-guides-banner.md %}